<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Ribs.js Intro</title>

    <style type="text/css">
        @import "jquery.svg.css";

        #mySvg {
            width: 640px;
            height: 480px;
            border: 1px solid black;
        }
    </style>
	<script type="text/javascript" src="jquery-1.4.2.js"></script>
    <script type="text/javascript" src="jquery.svg.js"></script>
    <script type="text/javascript" src="jquery.svgdom.js"></script>
    <script type="text/javascript" src="jquery.svganim.js"></script>

	<script type="text/javascript">

        $(function () {
            var svg = $('#mySvg').svg({
                    loadURL: "ribs.svg",
                    onLoad: loadDone,
                    settings: {addTo: true}
                }),
                screens = [];

            // Callback after loading external document
            function loadDone(svg, error) {
                console.log(svg.root());

                slides = [];
                $("defs rect", svg.root()).each(function (index, value) {
                    var $value = $(value), slide = {
                        x: $value.attr("x"), y: $value.attr("y"),
                        width: $value.attr("width"), height: $value.attr("height"),
                        sideways: ($value.attr("height") > $value.attr("width"))
                    };
                    slides.push(slide);
                });

                console.log(screens);

                $("#SVGID_4_, #SVGID_5_, #SVGID_6_", svg.root()).remove();

                mainGroup = $("g:first", svg.root());
            }
        });

        var mainGroup, slides = [],
            currentSlideIndex = -1,
            showNextSlide = function () {
                currentSlideIndex = (currentSlideIndex + 1) % slides.length;
                var currentTransformation = mainGroup.attr("transform"),
                    oldTranslate = currentTransformation.match(/translate\(([-\.0-9]*),([-\.0-9]*)\)/),
                    oldTranslateX = oldTranslate ? parseFloat(oldTranslate[1]) : 0,
                    oldTranslateY = oldTranslate ? parseFloat(oldTranslate[2]) : 0,
                    oldScale = currentTransformation.match(/scale\(([-\.0-9]*),([-\.0-9]*)\)/),
                    oldScaleX = oldScale ? parseFloat(oldScale[1]) : 1,
                    oldScaleY = oldScale ? parseFloat(oldScale[2]) : 1,
                    slide = slides[currentSlideIndex],
                    scaleX = 1 + $("#mySvg").width() / slide.width,
                    scaleY = 1 + $("#mySvg").height() / slide.height,
                    scaleString = "scale(" + scaleX + " " + scaleY + ")",
                    translateX = -slide.x * scaleX,
                    translateY = -slide.y * scaleY,
                    translateString = "translate(" + translateX + " " + translateY + ")",
                    transformString = translateString + " " + scaleString;
                console.log(transformString);
                mainGroup.animate({svgTransform: transformString}, 2000);
            };

	</script>
</head>
<body onclick="showNextSlide()">

<div id="mySvg"></div>

</body>
</html>